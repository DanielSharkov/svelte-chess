!function(e){var n={};function t(l){if(n[l])return n[l].exports;var r=n[l]={i:l,l:!1,exports:{}};return e[l].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,l){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:l})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(t.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(l,r,function(n){return e[n]}.bind(null,r));return l},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){e.exports=t(5)},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){"use strict";function l(){}t.r(n);const r=e=>e;function s(e){return e()}function o(){return Object.create(null)}function i(e){e.forEach(s)}function a(e){return"function"==typeof e}function c(e,n){return e!=e?n==n:e!==n||e&&"object"==typeof e||"function"==typeof e}function u(e,n,t){const l=n.subscribe(t);e.$$.on_destroy.push(l.unsubscribe?()=>l.unsubscribe():l)}const d="undefined"!=typeof window;let f=d?()=>window.performance.now():()=>Date.now(),h=d?requestAnimationFrame:l;const p=new Set;let v,g=!1;function m(){p.forEach(e=>{e[0](f())||(p.delete(e),e[1]())}),(g=p.size>0)&&h(m)}function y(e){let n;return g||(g=!0,h(m)),{promise:new Promise(t=>{p.add(n=[e,t])}),abort(){p.delete(n)}}}function w(e,n){e.appendChild(n)}function b(e,n,t){e.insertBefore(n,t||null)}function $(e){e.parentNode.removeChild(e)}function x(e,n){for(let t=0;t<e.length;t+=1)e[t]&&e[t].d(n)}function S(e){return document.createElement(e)}function k(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function N(e){return document.createTextNode(e)}function P(){return N(" ")}function C(e,n,t,l){return e.addEventListener(n,t,l),()=>e.removeEventListener(n,t,l)}function B(e,n,t){null==t?e.removeAttribute(n):e.setAttribute(n,t)}function E(e,n){n=""+n,e.data!==n&&(e.data=n)}function M(e,n,t){e.style.setProperty(n,t)}function _(e,n,t){e.classList[t?"add":"remove"](n)}function O(e,n){const t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,n),t}let I,T=0,H={};function j(e,n,t,l,r,s,o,i=0){const a=16.666/l;let c="{\n";for(let e=0;e<=1;e+=a){const l=n+(t-n)*s(e);c+=100*e+`%{${o(l,1-l)}}\n`}const u=c+`100% {${o(t,1-t)}}\n}`,d=`__svelte_${function(e){let n=5381,t=e.length;for(;t--;)n=(n<<5)-n^e.charCodeAt(t);return n>>>0}(u)}_${i}`;if(!H[d]){if(!v){const e=S("style");document.head.appendChild(e),v=e.sheet}H[d]=!0,v.insertRule(`@keyframes ${d} ${u}`,v.cssRules.length)}const f=e.style.animation||"";return e.style.animation=`${f?`${f}, `:""}${d} ${l}ms linear ${r}ms 1 both`,T+=1,d}function L(e,n){e.style.animation=(e.style.animation||"").split(", ").filter(n?e=>e.indexOf(n)<0:e=>-1===e.indexOf("__svelte")).join(", "),n&&!--T&&h(()=>{if(T)return;let e=v.cssRules.length;for(;e--;)v.deleteRule(e);H={}})}function A(e){I=e}const G=[],z=Promise.resolve();let W=!1;const R=[],F=[],q=[];function K(){W||(W=!0,z.then(D))}function U(e){F.push(e)}function D(){const e=new Set;do{for(;G.length;){const e=G.shift();A(e),Q(e.$$)}for(;R.length;)R.shift()();for(;F.length;){const n=F.pop();e.has(n)||(n(),e.add(n))}}while(G.length);for(;q.length;)q.pop()();W=!1}function Q(e){e.fragment&&(e.update(e.dirty),i(e.before_render),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_render.forEach(U))}let J,V;function X(){return J||(J=Promise.resolve()).then(()=>{J=null}),J}function Y(e,n,t){e.dispatchEvent(O(`${n?"intro":"outro"}${t}`))}function Z(){V={remaining:0,callbacks:[]}}function ee(){V.remaining||i(V.callbacks)}function ne(e){V.callbacks.push(e)}function te(e,n,t,s){let o=n(e,t),c=s?0:1,u=null,d=null,h=null;function p(){h&&L(e,h)}function v(e,n){const t=e.b-c;return n*=Math.abs(t),{a:c,b:e.b,d:t,duration:n,start:e.start,end:e.start+n,group:e.group}}function g(n){const{delay:t=0,duration:s=300,easing:a=r,tick:g=l,css:m}=o,w={start:f()+t,b:n};n||(w.group=V,V.remaining+=1),u?d=w:(m&&(p(),h=j(e,c,n,s,t,a,m)),n&&g(0,1),u=v(w,s),U(()=>Y(e,n,"start")),y(n=>{if(d&&n>d.start&&(u=v(d,s),d=null,Y(e,u.b,"start"),m&&(p(),h=j(e,c,u.b,u.duration,0,a,o.css))),u)if(n>=u.end)g(c=u.b,1-c),Y(e,u.b,"end"),d||(u.b?p():--u.group.remaining||i(u.group.callbacks)),u=null;else if(n>=u.start){const e=n-u.start;c=u.a+u.d*a(e/u.duration),g(c,1-c)}return!(!u&&!d)}))}return{run(e){a(o)?X().then(()=>{o=o(),g(e)}):g(e)},end(){p(),u=d=null}}}let le;function re(e,n,t){const{fragment:l,on_mount:r,on_destroy:o,after_render:c}=e.$$;l.m(n,t),U(()=>{const n=r.map(s).filter(a);o?o.push(...n):i(n),e.$$.on_mount=[]}),c.forEach(U)}function se(e,n){e.$$&&(i(e.$$.on_destroy),e.$$.fragment.d(n),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={})}function oe(e,n,t,r,s,a){const c=I;A(e);const u=n.props||{},d=e.$$={fragment:null,ctx:null,props:a,update:l,not_equal:s,bound:o(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(c?c.$$.context:[]),callbacks:o(),dirty:null};let f=!1;var h;d.ctx=t?t(e,u,(n,t)=>{d.ctx&&s(d.ctx[n],d.ctx[n]=t)&&(d.bound[n]&&d.bound[n](t),f&&function(e,n){e.$$.dirty||(G.push(e),K(),e.$$.dirty=o()),e.$$.dirty[n]=!0}(e,n))}):u,d.update(),f=!0,i(d.before_render),d.fragment=r(d.ctx),n.target&&(n.hydrate?d.fragment.l((h=n.target,Array.from(h.childNodes))):d.fragment.c(),n.intro&&e.$$.fragment.i&&e.$$.fragment.i(),re(e,n.target,n.anchor),D()),A(c)}"undefined"!=typeof HTMLElement&&(le=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,n,t){this[e]=t}$destroy(){se(this,!0),this.$destroy=l}$on(e,n){const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const e=t.indexOf(n);-1!==e&&t.splice(e,1)}}$set(){}});class ie{$destroy(){se(this,!0),this.$destroy=l}$on(e,n){const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const e=t.indexOf(n);-1!==e&&t.splice(e,1)}}$set(){}}function ae(e,n=l){let t;const r=[];function s(n){if(c(e,n)){if(e=n,!t)return;r.forEach(e=>e[1]()),r.forEach(n=>n[0](e))}}return{set:s,update:function(n){s(n(e))},subscribe:function(o,i=l){const a=[o,i];return r.push(a),1===r.length&&(t=n(s)||l),o(e),()=>{const e=r.indexOf(a);-1!==e&&r.splice(e,1),0===r.length&&t()}}}}function ce(e){let n;return e.subscribe(e=>n=e)(),n}function ue(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,e=>{let n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)})}var de={KING:function(e,n){if(void 0===e)throw new Error('missing player type for "King"');if(void 0===n)throw new Error("missing game store");let t;n(e=>t=e);const{subscribe:l,update:r}=ae({position:{row:0,col:0}});let s=!1,o=0,i=0;Object.defineProperties(this,{name:{value:"King"},id:{value:ue()},player:{value:e},figure:{value:`king-${e.type}`},subscribe:{value:l},getPosition:{value:()=>({row:o,col:i})},setPosition:{value(e,n){r(t=>(t.position={row:e,col:n},o=e,i=n,t))}},beat:{value:()=>s=!0},isBeaten:{value:()=>s},isMoveAllowed:{value:(n,l,r,s)=>(t.chessfield[r][s],"white"==e.type&&(n=7-n,r=7-r),!(r!==n-1&&r!==n&&r!==n+1||s!==l-1&&s!==l&&s!==l+1))}})},QUEEN:function(e,n){if(void 0===e)throw new Error('missing player type for "Queen"');if(void 0===n)throw new Error("missing game store");let t;n(e=>t=e);const{subscribe:l,update:r}=ae({position:{row:0,col:0}});let s=!1,o=0,i=0;Object.defineProperties(this,{name:{value:"Queen"},id:{value:ue()},player:{value:e},figure:{value:`queen-${e.type}`},subscribe:{value:l},getPosition:{value:()=>({row:o,col:i})},setPosition:{value(e,n){r(t=>(t.position={row:e,col:n},o=e,i=n,t))}},beat:{value:()=>s=!0},isBeaten:{value:()=>s},isMoveAllowed:{value:(n,l,r,s)=>(t.chessfield[r][s],"white"==e.type&&(n=7-n,r=7-r),!0)}})},ROOK:function(e,n){if(void 0===e)throw new Error('missing player type for "Rook"');if(void 0===n)throw new Error("missing game store");let t;n(e=>t=e);const{subscribe:l,update:r}=ae({position:{row:0,col:0}});let s=!1,o=0,i=0;Object.defineProperties(this,{name:{value:"Rook"},id:{value:ue()},player:{value:e},figure:{value:`rook-${e.type}`},subscribe:{value:l},getPosition:{value:()=>({row:o,col:i})},setPosition:{value(e,n){r(t=>(t.position={row:e,col:n},o=e,i=n,t))}},beat:{value:()=>s=!0},isBeaten:{value:()=>s},isMoveAllowed:{value(n,l,r,s){let o=t.chessfield[r][s];if(l===s){if(r>n){for(let e=n+1;e<=r-1;e++)if(null!==t.chessfield[e][l])return!1}else if(r<n)for(let e=n-1;e>=r+1;e--)if(null!==t.chessfield[e][l])return!1}else if(n===r)if(s>l){for(let e=l+1;e<=s-1;e++)if(null!==t.chessfield[n][e])return!1}else if(s<l)for(let e=l-1;e>=s+1;e--)if(null!==t.chessfield[n][e])return!1;return!(n!==r&&l!==s||null!==o&&o.player===e)}}})},BISHOP:function(e,n){if(void 0===e)throw new Error('missing player type for "Bishop"');if(void 0===n)throw new Error("missing game store");let t;n(e=>t=e);const{subscribe:l,update:r}=ae({position:{row:0,col:0}});let s=!1,o=0,i=0;Object.defineProperties(this,{name:{value:"Bishop"},id:{value:ue()},player:{value:e},figure:{value:`bishop-${e.type}`},subscribe:{value:l},getPosition:{value:()=>({row:o,col:i})},setPosition:{value(e,n){r(t=>(t.position={row:e,col:n},o=e,i=n,t))}},beat:{value:()=>s=!0},isBeaten:{value:()=>s},isMoveAllowed:{value(n,l,r,s){let o=t.chessfield[r][s],i=0,a=0,c=()=>!1,u=()=>0,d=()=>0;for(n>r?(i=n-1,c=()=>n>r,u=()=>{i--}):(i=n+1,c=()=>r>n,u=()=>{i++}),l>s?(a=l-1,d=()=>{a--}):(a=l+1,d=()=>{a++});c();){const n=t.chessfield[i][a];if(i===r&&a===s){if(null!==n&&n.player===e)return!1;if(null===o||o.player!==e)return!0}else if(null!==n)return!1;d(),u()}return!1}}})},KNIGHT:function(e,n){if(void 0===e)throw new Error('missing player type for "Knight"');if(void 0===n)throw new Error("missing game store");let t;n(e=>t=e);const{subscribe:l,update:r}=ae({position:{row:0,col:0}});let s=!1,o=0,i=0;Object.defineProperties(this,{name:{value:"Knight"},id:{value:ue()},player:{value:e},figure:{value:`knight-${e.type}`},subscribe:{value:l},getPosition:{value:()=>({row:o,col:i})},setPosition:{value(e,n){r(t=>(t.position={row:e,col:n},o=e,i=n,t))}},beat:{value:()=>s=!0},isBeaten:{value:()=>s},isMoveAllowed:{value:(n,l,r,s)=>(t.chessfield[r][s],"white"==e.type&&(n=7-n,r=7-r),!0)}})},PAWN:function(e,n){if(void 0===e)throw new Error('missing player type for "Pawn"');if(void 0===n)throw new Error("missing game store");let t;n(e=>t=e);const{subscribe:l,update:r}=ae({position:{row:0,col:0}});let s=!1,o=0,i=0;Object.defineProperties(this,{name:{value:"Pawn"},id:{value:ue()},player:{value:e},figure:{value:`pawn-${e.type}`},subscribe:{value:l},getPosition:{value:()=>({row:o,col:i})},setPosition:{value(e,n){r(t=>(t.position={row:e,col:n},o=e,i=n,t))}},beat:{value:()=>s=!0},isBeaten:{value:()=>s},isMoveAllowed:{value(n,l,r,s){let o=t.chessfield[r][s];if("white"==e.type&&(n=7-n,r=7-r),null==o&&l==s&&n>r){if(n>3&&r>3)return!0;if(n-1<=r&&null==o)return!0}else if(l!=s&&n-1===r&&(s==l+1||s==l-1)&&null!=o&&o.player!=e)return!0;return!1}}})}};function fe(e,n,t){if(void 0===e)throw new Error("missing player type");const l=t,{subscribe:r,update:s,set:o}=ae({totalTurns:0,turnsHistory:[],chessPieces:[],enemyPieces:[]});Object.defineProperties(this,{subscribe:{value:r},id:{value:ue()},type:{value:e},takeTurn:{value(e,n,t,l,r,o){let i=null;if(null===e?i="missing from row":null===n?i="missing from col":null===t?i="missing to row":null===l&&(i="missing to col"),null!==i)throw new Error(`game crash: ${i}`);s(s=>{let i=null;if(null!==o){if(!(o instanceof de.KING||o instanceof de.QUEEN||o instanceof de.ROOK||o instanceof de.BISHOP||o instanceof de.KNIGHT||o instanceof de.PAWN))throw console.log(o instanceof de.PAWN),new Error(`not a chess piece: ${o} (${typeof o})`);i=o,s.enemyPieces.unshift(o),o.beat()}return s.totalTurns++,s.turnsHistory.unshift({from:{row:e,col:n},to:{row:t,col:l},beatenPiece:i,beatenBy:r,time:Date.now()}),s})}},reset:{value(e){if(e!==l)throw new Error("reset player not permitted");o({totalTurns:0,turnsHistory:[],chessPieces:[new de.ROOK(this,n),new de.KNIGHT(this,n),new de.BISHOP(this,n),new de.KING(this,n),new de.QUEEN(this,n),new de.BISHOP(this,n),new de.KNIGHT(this,n),new de.ROOK(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n)],enemyPieces:[]})}}}),s(e=>(e.chessPieces=[new de.ROOK(this,n),new de.KNIGHT(this,n),new de.BISHOP(this,n),new de.KING(this,n),new de.QUEEN(this,n),new de.BISHOP(this,n),new de.KNIGHT(this,n),new de.ROOK(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n),new de.PAWN(this,n)],e))}var he=new function(){let e="";const n={currentBgId:"",chessFancy:!0,backgrounds:{"3f92043752ba4579b942783cbf786e05":"https://wallpapertag.com/wallpaper/full/0/7/7/980537-full-size-greek-mythology-wallpapers-1920x1080-720p.jpg",a405f36825f44fbbaf36798933b0acb7:"https://newevolutiondesigns.com/images/freebies/retro-wallpaper-17.jpg",c3385988c98b42a1a516d4b25d8dc095:"https://natewren.com/themes/wallpaper2/radpack/radpack_15.jpg","3faf4ebf32a34be8a53fdb9d873c0639":"https://freewallpap.files.wordpress.com/2012/01/the-best-top-desktop-space-wallpapers-0r-hd-space-wallpaper-planets.jpg",a3a528d343244a8aab6812792a3fca22:"https://wallpapershome.com/images/pages/pic_hs/6289.jpg",bfb52661e9004eb980eb6c6ef09e9386:"https://www.pixelstalk.net/wp-content/uploads/2016/10/Anime-Landscape-Wallpaper-HD.jpg","6e590dd631ed41fabc9a3493c5c7cff7":"https://onehdwallpaper.com/wp-content/uploads/2016/07/Fantasy-Landscape-Desktop-Background.jpg"}};if(void 0!==localStorage)if(localStorage.getItem("isInitialized"))n.currentBgId=localStorage.getItem("currentBgId"),n.chessFancy="true"===localStorage.getItem("chessFancy"),n.backgrounds=JSON.parse(localStorage.getItem("backgrounds")),e=n.backgrounds[n.currentBgId];else{localStorage.setItem("isInitialized",!0),localStorage.setItem("chessFancy",n.chessFancy),localStorage.setItem("backgrounds",JSON.stringify(n.backgrounds));const t=Object.keys(n.backgrounds)[0];localStorage.setItem("currentBgId",t),e=n.backgrounds[t]}const{subscribe:t,update:l}=ae({chessfield:[[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]],selectedField:{id:null,row:null,col:null,value:null},hoveringMove:{hovering:!1,from:{row:null,col:null},to:{row:null,col:null}},hoveringTarget:{hovering:!1,id:null,row:null,col:null},inProcess:!1,currentPlayerTurn:{},modal:{name:null,component:null,data:null,state:!1},modals:{},currentBgId:n.currentBgId,currentBgURL:e,fancyGraphics:n.chessFancy,backgrounds:n.backgrounds}),r=ue(),s=ue();Object.defineProperties(this,{subscribe:{value:t},start:{value(){let e=null;return l(n=>{if(n.inProcess)e=new Error("game is already in process");else{n.inProcess=!0,n.currentPlayerTurn=this.playerWhite;const e=ce(this.playerWhite).chessPieces;for(let t=0;t<2;t++)for(let l=0;l<8;l++)n.chessfield[t][l]=e[8*t+l],e[8*t+l].setPosition(t,l);const t=ce(this.playerBlack).chessPieces;for(let e=1;e>=0;e--)for(let l=7;l>=0;l--)n.chessfield[7-e][7-l]=t[8*e+l],t[8*e+l].setPosition(7-e,7-l)}return n}),e}},exit:{value:()=>{if(!ce(this).inProcess)return new Error("game not started");const e=this.playerWhite.reset(r);if(e instanceof Error)throw e;const n=this.playerBlack.reset(s);if(n instanceof Error)throw n;l(e=>(e.inProcess=!1,e.selectedField={id:null,row:null,col:null,value:null},e.chessfield=[[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]],e.currentPlayerTurn={},e))}},playerWhite:{value:new fe("white",t,r)},playerBlack:{value:new fe("black",t,s)},selectField:{value(e,n){return ce(this).inProcess?(l(t=>{const l=t.selectedField,r=t.chessfield[e][n];if(`${e}${n}`==l.id)t.selectedField={id:null,row:null,col:null,value:null};else if(null!==r&&l.id!=`${e}${n}`&&r.player===t.currentPlayerTurn)t.selectedField={id:`${e}${n}`,col:n,row:e,value:r};else if(null!==t.selectedField.id&&(null===r||r.player!==t.currentPlayerTurn)&&t.chessfield[l.row][l.col].isMoveAllowed(l.row,l.col,e,n))switch(t.currentPlayerTurn.takeTurn(l.row,l.col,e,n,t.chessfield[l.row][l.col],t.chessfield[e][n]),t.chessfield[e][n]=l.value,l.value.setPosition(e,n),t.chessfield[l.row][l.col]=null,t.selectedField={id:null,row:null,col:null,value:null},t.currentPlayerTurn){case this.playerBlack:t.currentPlayerTurn=this.playerWhite;break;case this.playerWhite:t.currentPlayerTurn=this.playerBlack}return t}),null):new Error("game not started")}},hoverTarget:{value(e){l(n=>{if(null==e)n.hoveringTarget={hovering:!1,id:null,row:null,col:null};else if(!e.isBeaten()){let t=ce(e);n.hoveringTarget={hovering:!0,id:e.id,row:t.position.row,col:t.position.col}}return n})}},hoverMove:{value(e,n){l(t=>(t.hoveringMove=null==e?{hovering:!1,from:{row:null,col:null},to:{row:null,col:null}}:{hovering:!0,from:e,to:n},t))}},newBG:{value(e){l(n=>{for(const t in n.backgrounds)if(e===n.backgrounds[t])return n;n.backgrounds[ue()]=e,localStorage&&localStorage.setItem("backgrounds",JSON.stringify(n.backgrounds))})}},changeBG:{value(e){l(n=>{if(void 0===e&&"string"!=typeof e)throw new Error("providen background id not a string");return n.currentBgId=e,n.currentBgURL=n.backgrounds[e],localStorage&&localStorage.setItem("currentBgId",e),n})}},removeBG:{value(e){l(n=>{if(void 0===e&&"string"!=typeof e)throw new Error("providen background id not a string");if(delete n.backgrounds[e],localStorage.setItem("backgrounds",JSON.stringify(n.backgrounds)),e===n.currentBgId){const e=Object.keys(n.backgrounds);e.length>0?this.changeBG(n.backgrounds[e[e.length-1]]):this.changeBG("")}return n})}},toggleGraphics:{value(){l(e=>(e.fancyGraphics=!e.fancyGraphics,void 0!==localStorage&&localStorage.setItem("chessFancy",e.fancyGraphics),e))}},newModal:{value(e,n){l(t=>{if(void 0!==t.modals[e])throw new Error("cannot register modals with same name");return t.modals[e]={component:n},t})}},openModal:{value(e,n){l(t=>{if("string"!=typeof e)throw new Error("provided name is not a string");if(!(e in t.modals))throw new Error(`modal '${e}' not registered`);return t.modal={name:e,component:t.modals[e].component,data:n,state:!0},t})}},pendCloseModal:{value(){l(e=>(e.modal.state=!1,e))}},closeModal:{value(){setTimeout(()=>l(e=>(e.modal={name:null,component:null,data:null,state:!1},e)))}}})};t(1);function pe(e,n,t){const l=Object.create(e);return l.piece=n[t],l}function ve(e,n,t){const l=Object.create(e);return l.turn=n[t],l.index=t,l}function ge(e){var n;return{c(){(n=S("span")).textContent="No turns made yet",n.className="empty svelte-178qnl3"},m(e,t){b(e,n,t)},d(e){e&&$(n)}}}function me(e){var n,t,l,r,s,o,i;return{c(){n=k("svg"),t=k("path"),l=P(),r=S("img"),B(t,"stroke-width",".3rem"),B(t,"d","M34 45L18 28V18h10l17 17M43 67l39-39V18H72L33 57m10 10L28 83 17 72l16-15m10 10L33 57m10 10l5 5M33 57l-5-5M57 67l15 16 11-11-16-15M57 67l10-10M57 67l-5 5m15-15l5-5"),B(n,"class","icon svelte-178qnl3"),B(n,"xmlns","http://www.w3.org/2000/svg"),B(n,"viewBox","0 0 100 100"),B(n,"fill","none"),B(r,"piece-id",s=e.turn.beatenPiece.id),r.className="figure svelte-178qnl3",r.src=o="/chesspieces/"+e.turn.beatenPiece.figure+".svg",r.alt=i=e.turn.beatenPiece.name+" "+e.turn.beatenPiece.player},m(e,s){b(e,n,s),w(n,t),b(e,l,s),b(e,r,s)},p(e,n){e.$player&&s!==(s=n.turn.beatenPiece.id)&&B(r,"piece-id",s),e.$player&&o!==(o="/chesspieces/"+n.turn.beatenPiece.figure+".svg")&&(r.src=o),e.$player&&i!==(i=n.turn.beatenPiece.name+" "+n.turn.beatenPiece.player)&&(r.alt=i)},d(e){e&&($(n),$(l),$(r))}}}function ye(e){var n,t,l,r,s,o,a,c,u,d,f,h,p,v,g,m,y,x,M,O,I,T=xe(e.turn.from.col),H=e.turn.from.row+1,j=xe(e.turn.to.col),L=e.turn.to.row+1,A=new Date(e.turn.time).toLocaleTimeString("en-US",{hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"}),G=e.turn.beatenPiece&&me(e);function z(){return e.mouseover_handler(e)}return{c(){n=S("div"),t=S("img"),o=P(),a=S("span"),c=N(T),u=N(H),d=P(),f=k("svg"),h=k("path"),p=P(),v=S("span"),g=N(j),m=N(L),y=P(),G&&G.c(),x=P(),M=S("span"),O=N(A),B(t,"piece-id",l=e.turn.beatenBy.id),t.className="figure svelte-178qnl3",t.src=r="/chesspieces/"+e.turn.beatenBy.figure+".svg",t.alt=s=e.turn.beatenBy.name+" "+e.turn.beatenBy.player,a.className="from svelte-178qnl3",B(h,"stroke-linecap","round"),B(h,"stroke-linejoin","round"),B(h,"stroke-width",".4rem"),B(h,"d","M10 50h80m0 0L75 70m15-20L75 30"),B(f,"class","icon svelte-178qnl3"),B(f,"xmlns","http://www.w3.org/2000/svg"),B(f,"viewBox","0 0 100 100"),v.className="to svelte-178qnl3",M.className="time svelte-178qnl3",n.className="entry svelte-178qnl3",_(n,"hovering",e.isHoveringEntry(e.turn.beatenPiece)),I=[C(n,"mouseover",z),C(n,"mouseleave",e.mouseLeaveEntry)]},m(e,l){b(e,n,l),w(n,t),w(n,o),w(n,a),w(a,c),w(a,u),w(n,d),w(n,f),w(f,h),w(n,p),w(n,v),w(v,g),w(v,m),w(n,y),G&&G.m(n,null),w(n,x),w(n,M),w(M,O)},p(o,i){e=i,o.$player&&l!==(l=e.turn.beatenBy.id)&&B(t,"piece-id",l),o.$player&&r!==(r="/chesspieces/"+e.turn.beatenBy.figure+".svg")&&(t.src=r),o.$player&&s!==(s=e.turn.beatenBy.name+" "+e.turn.beatenBy.player)&&(t.alt=s),o.$player&&T!==(T=xe(e.turn.from.col))&&E(c,T),o.$player&&H!==(H=e.turn.from.row+1)&&E(u,H),o.$player&&j!==(j=xe(e.turn.to.col))&&E(g,j),o.$player&&L!==(L=e.turn.to.row+1)&&E(m,L),e.turn.beatenPiece?G?G.p(o,e):((G=me(e)).c(),G.m(n,x)):G&&(G.d(1),G=null),o.$player&&A!==(A=new Date(e.turn.time).toLocaleTimeString("en-US",{hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"}))&&E(O,A),(o.isHoveringEntry||o.$player)&&_(n,"hovering",e.isHoveringEntry(e.turn.beatenPiece))},d(e){e&&$(n),G&&G.d(),i(I)}}}function we(e){var n;return{c(){(n=S("span")).textContent="No beaten pieces",n.className="empty svelte-178qnl3"},m(e,t){b(e,n,t)},d(e){e&&$(n)}}}function be(e){var n,t,l,r,s,o,a;function c(){return e.mouseover_handler_1(e)}return{c(){n=S("div"),t=S("img"),o=P(),B(t,"piece-id",l=e.piece.id),t.className="figure",t.src=r="/chesspieces/"+e.piece.figure+".svg",t.alt=s=e.piece.name+" "+e.piece.player,n.className="entry svelte-178qnl3",_(n,"hovering",e.isHoveringEntry(e.piece)),a=[C(n,"mouseover",c),C(n,"mouseleave",e.mouseLeaveEntry)]},m(e,l){b(e,n,l),w(n,t),w(n,o)},p(o,i){e=i,o.$player&&l!==(l=e.piece.id)&&B(t,"piece-id",l),o.$player&&r!==(r="/chesspieces/"+e.piece.figure+".svg")&&(t.src=r),o.$player&&s!==(s=e.piece.name+" "+e.piece.player)&&(t.alt=s),(o.isHoveringEntry||o.$player)&&_(n,"hovering",e.isHoveringEntry(e.piece))},d(e){e&&$(n),i(a)}}}function $e(e){for(var n,t,r,s,o,i,a,c,u,d,f,h,p,v,g,m,y,k,C=e.player.type,B=e.$player.totalTurns,M=e.$player.enemyPieces.length,O=e.$player.turnsHistory.length<1&&ge(),I=e.$player.turnsHistory,T=[],H=0;H<I.length;H+=1)T[H]=ye(ve(e,I,H));var j=e.$player.enemyPieces.length<1&&we(),L=e.$player.enemyPieces,A=[];for(H=0;H<L.length;H+=1)A[H]=be(pe(e,L,H));return{c(){n=S("div"),t=S("h1"),r=N(C),s=P(),o=S("h4"),i=N(B),a=N(" Turns"),c=P(),u=S("div"),O&&O.c(),d=P();for(var l=0;l<T.length;l+=1)T[l].c();f=P(),h=S("h4"),p=N(M),v=N(" Beaten pieces"),g=P(),m=S("div"),j&&j.c(),y=P();for(l=0;l<A.length;l+=1)A[l].c();t.className="title svelte-178qnl3",o.className="svelte-178qnl3",u.className="turns-history svelte-178qnl3",h.className="svelte-178qnl3",m.className="enemy-pieces svelte-178qnl3",n.className=k="player "+e.player.type+" svelte-178qnl3",_(n,"fancy",e.$Chess.fancyGraphics)},m(e,l){b(e,n,l),w(n,t),w(t,r),w(n,s),w(n,o),w(o,i),w(o,a),w(n,c),w(n,u),O&&O.m(u,null),w(u,d);for(var $=0;$<T.length;$+=1)T[$].m(u,null);w(n,f),w(n,h),w(h,p),w(h,v),w(n,g),w(n,m),j&&j.m(m,null),w(m,y);for($=0;$<A.length;$+=1)A[$].m(m,null)},p(e,t){if(e.player&&C!==(C=t.player.type)&&E(r,C),e.$player&&B!==(B=t.$player.totalTurns)&&E(i,B),t.$player.turnsHistory.length<1?O||((O=ge()).c(),O.m(u,d)):O&&(O.d(1),O=null),e.isHoveringEntry||e.$player||e.mouseLeaveEntry||e.toChar){I=t.$player.turnsHistory;for(var l=0;l<I.length;l+=1){const n=ve(t,I,l);T[l]?T[l].p(e,n):(T[l]=ye(n),T[l].c(),T[l].m(u,null))}for(;l<T.length;l+=1)T[l].d(1);T.length=I.length}if(e.$player&&M!==(M=t.$player.enemyPieces.length)&&E(p,M),t.$player.enemyPieces.length<1?j||((j=we()).c(),j.m(m,y)):j&&(j.d(1),j=null),e.isHoveringEntry||e.$player||e.mouseLeaveEntry){L=t.$player.enemyPieces;for(l=0;l<L.length;l+=1){const n=pe(t,L,l);A[l]?A[l].p(e,n):(A[l]=be(n),A[l].c(),A[l].m(m,null))}for(;l<A.length;l+=1)A[l].d(1);A.length=L.length}e.player&&k!==(k="player "+t.player.type+" svelte-178qnl3")&&(n.className=k),(e.player||e.$Chess)&&_(n,"fancy",t.$Chess.fancyGraphics)},i:l,o:l,d(e){e&&$(n),O&&O.d(),x(T,e),j&&j.d(),x(A,e)}}}function xe(e){switch(e){case 0:return"A";case 1:return"B";case 2:return"C";case 3:return"D";case 4:return"E";case 5:return"F";case 6:return"G";case 7:return"H";default:throw new Error("not a valid column")}}function Se(e,n,t){let l,r;u(e,he,e=>{t("$Chess",l=e)});let{player:s}=n;if(u(e,s,e=>{t("$player",r=e)}),void 0===s)throw new Error("Player not provided");let o,i="";function a(e,n,l,r){void 0!==l&&void 0!==r&&he.hoverMove(l,r),e&&(n&&he.hoverTarget(n),t("hoveringID",i=e.id))}return e.$set=e=>{"player"in e&&t("player",s=e.player)},e.$$.update=(e={hoveringID:1})=>{e.hoveringID&&t("isHoveringEntry",o=e=>!!e&&e.id===i)},{player:s,mouseOverEntry:a,mouseLeaveEntry:function(){t("hoveringID",i=""),he.hoverTarget(),he.hoverMove()},isHoveringEntry:o,$Chess:l,$player:r,mouseover_handler:function({turn:e}){return a(e.beatenPiece,e.beatenBy,e.from,e.to)},mouseover_handler_1:function({piece:e}){return a(e)}}}var ke=class extends ie{constructor(e){super(),oe(this,e,Se,$e,c,["player"])}};t(2);function Ne(e,n,t){const l=Object.create(e);return l.id=n[t],l}function Pe(e){var n,t,l,r,s,o;function a(){return e.click_handler(e)}function c(){return e.click_handler_1(e)}return{c(){n=S("button"),(t=S("button")).innerHTML='<svg class="icon svelte-13uw8lr" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 134 134"><path stroke-linecap="round" stroke-linejoin="round" stroke-width=".4rem" d="M35 99l64-64m0 64L35 35"></path></svg>',l=P(),t.className="remove svelte-13uw8lr",B(n,"image-id",r=e.id),B(n,"image-url",s=e.$Chess.backgrounds[e.id]),n.className="image svelte-13uw8lr",M(n,"background-image","url("+e.$Chess.backgrounds[e.id]+")"),_(n,"active",e.id===e.$Chess.currentBgId),o=[C(t,"click",a),C(n,"click",c)]},m(e,r){b(e,n,r),w(n,t),w(n,l)},p(t,l){e=l,t.$Chess&&r!==(r=e.id)&&B(n,"image-id",r),t.$Chess&&s!==(s=e.$Chess.backgrounds[e.id])&&B(n,"image-url",s),t.$Chess&&(M(n,"background-image","url("+e.$Chess.backgrounds[e.id]+")"),_(n,"active",e.id===e.$Chess.currentBgId))},d(e){e&&$(n),i(o)}}}function Ce(e){for(var n,t,r,s,o,a,c,u,d,f,h,p,v,g,m,y,k,N,E,M,O,I,T,H,j,L=Object.keys(e.$Chess.backgrounds),A=[],G=0;G<L.length;G+=1)A[G]=Pe(Ne(e,L,G));return{c(){n=S("div"),(t=S("h1")).textContent="Settings",r=P(),(s=S("button")).innerHTML='<svg class="icon svelte-13uw8lr" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 134 134"><path stroke-linecap="round" stroke-linejoin="round" stroke-width=".4rem" d="M35 99l64-64m0 64L35 35"></path></svg>',o=P(),a=S("section"),(c=S("h4")).textContent="Graphics",u=P(),d=S("button"),(f=S("span")).textContent="Low",h=P(),(p=S("span")).textContent="High",v=P(),g=S("div"),m=P(),y=S("section"),(k=S("h4")).textContent="Background",N=P(),E=S("div"),M=S("input"),O=P(),(I=S("button")).textContent="Set",T=P(),H=S("div");for(var l=0;l<A.length;l+=1)A[l].c();t.className="svelte-13uw8lr",s.className="close-modal svelte-13uw8lr",c.className="svelte-13uw8lr",f.className="svelte-13uw8lr",_(f,"active",!e.$Chess.fancyGraphics),p.className="svelte-13uw8lr",_(p,"active",e.$Chess.fancyGraphics),g.className="slide svelte-13uw8lr",d.className="toggle svelte-13uw8lr",_(d,"fancy",e.$Chess.fancyGraphics),a.className="graphics svelte-13uw8lr",k.className="svelte-13uw8lr",M.id="ownbg",M.placeholder="Own background - Paste URL here",B(M,"type","text"),M.className="svelte-13uw8lr",I.className="svelte-13uw8lr",E.className="own-bg svelte-13uw8lr",H.className="options svelte-13uw8lr",y.className="background svelte-13uw8lr",n.className="content svelte-13uw8lr",j=[C(s,"click",e.close),C(d,"click",he.toggleGraphics),C(M,"input",e.input_input_handler),C(I,"click",e.setNewBG)]},m(l,i){b(l,n,i),w(n,t),w(n,r),w(n,s),w(n,o),w(n,a),w(a,c),w(a,u),w(a,d),w(d,f),w(d,h),w(d,p),w(d,v),w(d,g),w(n,m),w(n,y),w(y,k),w(y,N),w(y,E),w(E,M),M.value=e.newBgURL,w(E,O),w(E,I),w(y,T),w(y,H);for(var $=0;$<A.length;$+=1)A[$].m(H,null)},p(e,n){if(e.$Chess&&(_(f,"active",!n.$Chess.fancyGraphics),_(p,"active",n.$Chess.fancyGraphics),_(d,"fancy",n.$Chess.fancyGraphics)),e.newBgURL&&M.value!==n.newBgURL&&(M.value=n.newBgURL),e.$Chess){L=Object.keys(n.$Chess.backgrounds);for(var t=0;t<L.length;t+=1){const l=Ne(n,L,t);A[t]?A[t].p(e,l):(A[t]=Pe(l),A[t].c(),A[t].m(H,null))}for(;t<A.length;t+=1)A[t].d(1);A.length=L.length}},i:l,o:l,d(e){e&&$(n),x(A,e),i(j)}}}function Be(e,n,t){let l;u(e,he,e=>{t("$Chess",l=e)});let{close:r}=n,s="";return e.$set=e=>{"close"in e&&t("close",r=e.close)},{close:r,newBgURL:s,setNewBG:function(){s.length>0&&(he.newBG(s),t("newBgURL",s=""))},$Chess:l,input_input_handler:function(){s=this.value,t("newBgURL",s)},click_handler:function({id:e}){return he.removeBG(e)},click_handler_1:function({id:e}){return he.changeBG(e)}}}var Ee=class extends ie{constructor(e){super(),oe(this,e,Be,Ce,c,["close"])}};function Me(e){const n=e-1;return n*n*n+1}function _e(e,{delay:n=0,duration:t=400}){const l=+getComputedStyle(e).opacity;return{delay:n,duration:t,css:e=>`opacity: ${e*l}`}}function Oe(e,{delay:n=0,duration:t=400,easing:l=Me,x:r=0,y:s=0,opacity:o=0}){const i=getComputedStyle(e),a=+i.opacity,c="none"===i.transform?"":i.transform,u=a*(1-o);return{delay:n,duration:t,easing:l,css:(e,n)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*r}px, ${(1-e)*s}px);\n\t\t\topacity: ${a-u*n}`}}t(3),t(4);function Ie(e,n,t){const l=Object.create(e);return l.field=n[t],l.colIndex=t,l}function Te(e,n,t){const l=Object.create(e);return l.row=n[t],l.rowIndex=t,l}function He(e,n,t){const l=Object.create(e);return l._=n[t],l.y=t,l}function je(e,n,t){const l=Object.create(e);return l._=n[t],l.y=t,l}function Le(e,n,t){const l=Object.create(e);return l._=n[t],l.x=t,l}function Ae(e,n,t){const l=Object.create(e);return l._=n[t],l.x=t,l}function Ge(e){var n,t,l,r,s,o,a,c=e.$Chess.modal.component;function u(e){return{props:{data:e.$Chess.modal.data,close:he.pendCloseModal}}}if(c)var d=new c(u(e));return{c(){n=S("div"),l=P(),r=S("div"),d&&d.$$.fragment.c(),n.className="background svelte-12fa0x5",r.className="modal svelte-12fa0x5",a=[C(n,"click",he.pendCloseModal),C(r,"outroend",he.closeModal)]},m(e,t){b(e,n,t),b(e,l,t),b(e,r,t),d&&re(d,r,null),o=!0},p(e,n){var t={};if(e.$Chess&&(t.data=n.$Chess.modal.data),e.Chess&&(t.close=he.pendCloseModal),c!==(c=n.$Chess.modal.component)){if(d){Z();const e=d;ne(()=>{e.$destroy()}),e.$$.fragment.o(1),ee()}c?((d=new c(u(n))).$$.fragment.c(),d.$$.fragment.i(1),re(d,r,null)):d=null}else c&&d.$set(t)},i(e){o||(U(()=>{t||(t=te(n,_e,{duration:300},!0)),t.run(1)}),d&&d.$$.fragment.i(e),U(()=>{s||(s=te(r,Oe,{y:300,duration:400},!0)),s.run(1)}),o=!0)},o(e){t||(t=te(n,_e,{duration:300},!1)),t.run(0),d&&d.$$.fragment.o(e),s||(s=te(r,Oe,{y:300,duration:400},!1)),s.run(0),o=!1},d(e){e&&($(n),t&&t.end(),$(l),$(r)),d&&d.$destroy(),e&&s&&s.end(),i(a)}}}function ze(e){var n,t,r,s,o;return{c(){n=S("div"),(t=S("h1")).textContent="Chess",r=P(),(s=S("button")).textContent="Start Game",s.className="svelte-12fa0x5",n.className="start-game svelte-12fa0x5",o=C(s,"click",e.startChess)},m(e,l){b(e,n,l),w(n,t),w(n,r),w(n,s)},p:l,i:l,o:l,d(e){e&&$(n),o()}}}function We(e){for(var n,t,l,r,s,o,a,c,u,d,f,h,p,v,g,m,y,k,N,B,E,_,O,I,T=new ke({props:{player:he.playerWhite}}),H=new ke({props:{player:he.playerBlack}}),j=Array(8),L=[],A=0;A<j.length;A+=1)L[A]=Re(Ae(e,j,A));var G=Array(8),z=[];for(A=0;A<G.length;A+=1)z[A]=Fe(Le(e,G,A));var W=Array(8),F=[];for(A=0;A<W.length;A+=1)F[A]=qe(je(e,W,A));var q=Array(8),K=[];for(A=0;A<q.length;A+=1)K[A]=Ke(He(e,q,A));var U=e.reversedChessfield(e.chessStore.chessfield),D=[];for(A=0;A<U.length;A+=1)D[A]=Qe(Te(e,U,A));var Q=e.chessStore.hoveringTarget.hovering&&Je(e),J=e.chessStore.hoveringMove.hovering&&Ve(e);return{c(){n=S("div"),t=S("div"),(l=S("button")).innerHTML='<svg class="icon svelte-12fa0x5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120" fill="none"><path stroke-linecap="round" stroke-linejoin="round" stroke-width=".5rem" d="M20 10h64v19M20 10v85l44 15V95M20 10l44 15v70m20-19v19H64m10-43h30m0 0L89 37m15 15L89 67"></path></svg>\n\t\t\t\t\t\t\t\t<span>Exit</span>',r=P(),(s=S("button")).innerHTML='<svg class="icon svelte-12fa0x5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120" fill="none"><path stroke-linecap="round" stroke-linejoin="round" stroke-width=".5rem" d="M21 32.4a4 4 0 0 1 0-5.6l5.8-5.8a4 4 0 0 1 5.6 0l5.4 5.2a8 8 0 0 0 13.5-5.8V16a4 4 0 0 1 4-4h9.4a4 4 0 0 1 4 4v4.4a8 8 0 0 0 13.5 5.8l5.4-5.2a4 4 0 0 1 5.6 0l5.8 5.8a4 4 0 0 1 0 5.6l-5.2 5.4a8 8 0 0 0 5.8 13.5h4.4a4 4 0 0 1 4 4v9.4a4 4 0 0 1-4 4h-3.4A8 8 0 0 0 95 82.5l4.5 4.3a4 4 0 0 1 0 5.7l-7.1 7.2a4 4 0 0 1-5.7-.1L82.5 95a8 8 0 0 0-13.8 5.5v3.4a4 4 0 0 1-4 4h-9.4a4 4 0 0 1-4-4v-3.4A8 8 0 0 0 37.5 95l-4.3 4.5a4 4 0 0 1-5.7 0l-7.2-7.1a4 4 0 0 1 .1-5.7l4.5-4.3a8 8 0 0 0-5.5-13.8H16a4 4 0 0 1-4-4v-9.4a4 4 0 0 1 4-4h4.4a8 8 0 0 0 5.8-13.5L21 32.4z"></path><circle cx="60" cy="60" r="16" stroke-width=".5rem"></circle></svg>\n\t\t\t\t\t\t\t\t<span>Settings</span>',o=P(),a=S("div"),T.$$.fragment.c(),c=P(),H.$$.fragment.c(),u=P(),d=S("div"),f=S("div"),h=S("div");for(var i=0;i<L.length;i+=1)L[i].c();p=P(),v=S("div");for(i=0;i<z.length;i+=1)z[i].c();g=P(),m=S("div");for(i=0;i<F.length;i+=1)F[i].c();y=P(),k=S("div");for(i=0;i<K.length;i+=1)K[i].c();N=P();for(i=0;i<D.length;i+=1)D[i].c();B=P(),E=S("div"),Q&&Q.c(),_=P(),J&&J.c(),l.className="svelte-12fa0x5",s.className="svelte-12fa0x5",t.className="menu svelte-12fa0x5",a.className="players-stats",n.className="overlay svelte-12fa0x5",h.className="indicator top svelte-12fa0x5",v.className="indicator bottom svelte-12fa0x5",m.className="indicator left svelte-12fa0x5",k.className="indicator right svelte-12fa0x5",f.className="indicators svelte-12fa0x5",M(f,"width",e.gameSize+"px"),M(f,"height",e.gameSize+"px"),d.className="chessfield svelte-12fa0x5",E.className="chessfield-overlay svelte-12fa0x5",M(E,"width",e.gameSize+"px"),M(E,"height",e.gameSize+"px"),I=[C(l,"click",he.exit),C(s,"click",e.click_handler)]},m(i,$){b(i,n,$),w(n,t),w(t,l),w(t,r),w(t,s),w(n,o),w(n,a),re(T,a,null),w(a,c),re(H,a,null),b(i,u,$),b(i,d,$),w(d,f),w(f,h);for(var x=0;x<L.length;x+=1)L[x].m(h,null);w(f,p),w(f,v);for(x=0;x<z.length;x+=1)z[x].m(v,null);w(f,g),w(f,m);for(x=0;x<F.length;x+=1)F[x].m(m,null);w(f,y),w(f,k);for(x=0;x<K.length;x+=1)K[x].m(k,null);w(d,N);for(x=0;x<D.length;x+=1)D[x].m(d,null);var S;S=()=>e.div8_binding(d,null),R.push(S),b(i,B,$),b(i,E,$),Q&&Q.m(E,null),w(E,_),J&&J.m(E,null),O=!0},p(e,n){var t={};e.Chess&&(t.player=he.playerWhite),T.$set(t);var l={};if(e.Chess&&(l.player=he.playerBlack),H.$set(l),e.toChar){j=Array(8);for(var r=0;r<j.length;r+=1){const t=Ae(n,j,r);L[r]?L[r].p(e,t):(L[r]=Re(t),L[r].c(),L[r].m(h,null))}for(;r<L.length;r+=1)L[r].d(1);L.length=j.length}if(e.toChar){G=Array(8);for(r=0;r<G.length;r+=1){const t=Le(n,G,r);z[r]?z[r].p(e,t):(z[r]=Fe(t),z[r].c(),z[r].m(v,null))}for(;r<z.length;r+=1)z[r].d(1);z.length=G.length}if(O&&!e.gameSize||(M(f,"width",n.gameSize+"px"),M(f,"height",n.gameSize+"px")),e.reversedChessfield||e.chessStore||e.cpt){U=n.reversedChessfield(n.chessStore.chessfield);for(r=0;r<U.length;r+=1){const t=Te(n,U,r);D[r]?D[r].p(e,t):(D[r]=Qe(t),D[r].c(),D[r].m(d,null))}for(;r<D.length;r+=1)D[r].d(1);D.length=U.length}e.items&&(n.div8_binding(null,d),n.div8_binding(d,null)),n.chessStore.hoveringTarget.hovering?Q?(Q.p(e,n),Q.i(1)):((Q=Je(n)).c(),Q.i(1),Q.m(E,_)):Q&&(Z(),ne(()=>{Q.d(1),Q=null}),Q.o(1),ee()),n.chessStore.hoveringMove.hovering?J?(J.p(e,n),J.i(1)):((J=Ve(n)).c(),J.i(1),J.m(E,null)):J&&(Z(),ne(()=>{J.d(1),J=null}),J.o(1),ee()),O&&!e.gameSize||(M(E,"width",n.gameSize+"px"),M(E,"height",n.gameSize+"px"))},i(e){O||(T.$$.fragment.i(e),H.$$.fragment.i(e),Q&&Q.i(),J&&J.i(),O=!0)},o(e){T.$$.fragment.o(e),H.$$.fragment.o(e),Q&&Q.o(),J&&J.o(),O=!1},d(t){t&&$(n),T.$destroy(),H.$destroy(),t&&($(u),$(d)),x(L,t),x(z,t),x(F,t),x(K,t),x(D,t),e.div8_binding(null,d),t&&($(B),$(E)),Q&&Q.d(),J&&J.d(),i(I)}}}function Re(e){var n,t,r=Ye(e.x);return{c(){n=S("div"),t=N(r),B(n,"x",e.x),n.className="svelte-12fa0x5"},m(e,l){b(e,n,l),w(n,t)},p:l,d(e){e&&$(n)}}}function Fe(e){var n,t,r=Ye(e.x);return{c(){n=S("div"),t=N(r),B(n,"x",e.x),n.className="svelte-12fa0x5"},m(e,l){b(e,n,l),w(n,t)},p:l,d(e){e&&$(n)}}}function qe(e){var n,t,r=7-e.y+1;return{c(){n=S("div"),t=N(r),B(n,"y",e.y),n.className="svelte-12fa0x5"},m(e,l){b(e,n,l),w(n,t)},p:l,d(e){e&&$(n)}}}function Ke(e){var n,t,r=7-e.y+1;return{c(){n=S("div"),t=N(r),B(n,"y",e.y),n.className="svelte-12fa0x5"},m(e,l){b(e,n,l),w(n,t)},p:l,d(e){e&&$(n)}}}function Ue(e){var n,t,l,r;return{c(){(n=S("img")).id=t=e.field.id,n.className="figure svelte-12fa0x5",n.src=l="/chesspieces/"+e.field.figure+".svg",n.alt=r=e.field.name+" "+e.field.player},m(e,t){b(e,n,t)},p(e,s){(e.reversedChessfield||e.chessStore)&&t!==(t=s.field.id)&&(n.id=t),(e.reversedChessfield||e.chessStore)&&l!==(l="/chesspieces/"+s.field.figure+".svg")&&(n.src=l),(e.reversedChessfield||e.chessStore)&&r!==(r=s.field.name+" "+s.field.player)&&(n.alt=r)},d(e){e&&$(n)}}}function De(e){var n,t,l,r=null!==e.field&&Ue(e);function s(){return e.click_handler_1(e)}return{c(){n=S("div"),r&&r.c(),n.className="field svelte-12fa0x5",B(n,"col",e.colIndex),B(n,"field",t=e.field?e.field.figure:e.field),_(n,"selected",e.chessStore.selectedField.id==`${7-e.rowIndex}${e.colIndex}`),_(n,"empty",null===e.field),_(n,"turn-player",null!=e.field&&e.field.player===e.cpt),l=C(n,"click",s)},m(e,t){b(e,n,t),r&&r.m(n,null)},p(l,s){null!==(e=s).field?r?r.p(l,e):((r=Ue(e)).c(),r.m(n,null)):r&&(r.d(1),r=null),(l.reversedChessfield||l.chessStore)&&t!==(t=e.field?e.field.figure:e.field)&&B(n,"field",t),l.chessStore&&_(n,"selected",e.chessStore.selectedField.id==`${7-e.rowIndex}${e.colIndex}`),(l.reversedChessfield||l.chessStore)&&_(n,"empty",null===e.field),(l.reversedChessfield||l.chessStore||l.cpt)&&_(n,"turn-player",null!=e.field&&e.field.player===e.cpt)},d(e){e&&$(n),r&&r.d(),l()}}}function Qe(e){for(var n,t=e.row,l=[],r=0;r<t.length;r+=1)l[r]=De(Ie(e,t,r));return{c(){n=S("div");for(var t=0;t<l.length;t+=1)l[t].c();n.className="row svelte-12fa0x5",B(n,"row",7-e.rowIndex)},m(e,t){b(e,n,t);for(var r=0;r<l.length;r+=1)l[r].m(n,null)},p(e,r){if(e.reversedChessfield||e.chessStore||e.cpt){t=r.row;for(var s=0;s<t.length;s+=1){const o=Ie(r,t,s);l[s]?l[s].p(e,o):(l[s]=De(o),l[s].c(),l[s].m(n,null))}for(;s<l.length;s+=1)l[s].d(1);l.length=t.length}},d(e){e&&$(n),x(l,e)}}}function Je(e){var n,t,l,r,s;return{c(){n=S("div"),(t=S("span")).textContent="Beaten by",n.className="hovering target svelte-12fa0x5",M(n,"left",e.fieldSize*e.chessStore.hoveringTarget.col+"px"),M(n,"top",e.fieldSize*(7-e.chessStore.hoveringTarget.row)+"px"),B(n,"piece-id",l=e.chessStore.hoveringTarget.id)},m(e,l){b(e,n,l),w(n,t),s=!0},p(e,t){(!s||e.fieldSize||e.chessStore)&&(M(n,"left",t.fieldSize*t.chessStore.hoveringTarget.col+"px"),M(n,"top",t.fieldSize*(7-t.chessStore.hoveringTarget.row)+"px")),s&&!e.chessStore||l===(l=t.chessStore.hoveringTarget.id)||B(n,"piece-id",l)},i(e){s||(U(()=>{r||(r=te(n,_e,{duration:200},!0)),r.run(1)}),s=!0)},o(e){r||(r=te(n,_e,{duration:200},!1)),r.run(0),s=!1},d(e){e&&($(n),r&&r.end())}}}function Ve(e){var n,t,l,r,s,o,i,a,c,u;return{c(){n=S("div"),(t=S("span")).textContent="Move from",s=P(),o=S("div"),(i=S("span")).textContent="Move to",n.className="hovering move from svelte-12fa0x5",M(n,"left",e.fieldSize*e.chessStore.hoveringMove.from.col+"px"),M(n,"top",e.fieldSize*(7-e.chessStore.hoveringMove.from.row)+"px"),B(n,"piece-id",l=e.chessStore.hoveringMove.from.id),o.className="hovering move to svelte-12fa0x5",M(o,"left",e.fieldSize*e.chessStore.hoveringMove.to.col+"px"),M(o,"top",e.fieldSize*(7-e.chessStore.hoveringMove.to.row)+"px"),B(o,"piece-id",a=e.chessStore.hoveringMove.to.id)},m(e,l){b(e,n,l),w(n,t),b(e,s,l),b(e,o,l),w(o,i),u=!0},p(e,t){(!u||e.fieldSize||e.chessStore)&&(M(n,"left",t.fieldSize*t.chessStore.hoveringMove.from.col+"px"),M(n,"top",t.fieldSize*(7-t.chessStore.hoveringMove.from.row)+"px")),u&&!e.chessStore||l===(l=t.chessStore.hoveringMove.from.id)||B(n,"piece-id",l),(!u||e.fieldSize||e.chessStore)&&(M(o,"left",t.fieldSize*t.chessStore.hoveringMove.to.col+"px"),M(o,"top",t.fieldSize*(7-t.chessStore.hoveringMove.to.row)+"px")),u&&!e.chessStore||a===(a=t.chessStore.hoveringMove.to.id)||B(o,"piece-id",a)},i(e){u||(U(()=>{r||(r=te(n,_e,{duration:200},!0)),r.run(1)}),U(()=>{c||(c=te(o,_e,{duration:200},!0)),c.run(1)}),u=!0)},o(e){r||(r=te(n,_e,{duration:200},!1)),r.run(0),c||(c=te(o,_e,{duration:200},!1)),c.run(0),u=!1},d(e){e&&($(n),r&&r.end(),$(s),$(o),c&&c.end())}}}function Xe(e){var n,t,l,r,s,o,i,a=null!==e.$Chess.modal.name&&e.$Chess.modal.name.length>0&&e.$Chess.modal.state&&Ge(e),c=[We,ze],u=[];function d(e){return e.chessStore.inProcess?0:1}return r=d(e),s=u[r]=c[r](e),{c(){n=S("div"),t=S("div"),a&&a.c(),l=P(),s.c(),t.className="modal-viewport svelte-12fa0x5",_(t,"active",e.$Chess.modal.state),n.id="game",M(n,"background-image","url("+e.$Chess.currentBgURL+")"),n.className="svelte-12fa0x5",_(n,"fancy",e.$Chess.fancyGraphics),i=C(window,"resize",e.onResize)},m(e,s){b(e,n,s),w(n,t),a&&a.m(t,null),w(n,l),u[r].m(n,null),o=!0},p(e,l){null!==l.$Chess.modal.name&&l.$Chess.modal.name.length>0&&l.$Chess.modal.state?a?(a.p(e,l),a.i(1)):((a=Ge(l)).c(),a.i(1),a.m(t,null)):a&&(Z(),ne(()=>{a.d(1),a=null}),a.o(1),ee()),e.$Chess&&_(t,"active",l.$Chess.modal.state);var i=r;(r=d(l))===i?u[r].p(e,l):(Z(),ne(()=>{u[i].d(1),u[i]=null}),s.o(1),ee(),(s=u[r])||(s=u[r]=c[r](l)).c(),s.i(1),s.m(n,null)),o&&!e.$Chess||M(n,"background-image","url("+l.$Chess.currentBgURL+")"),e.$Chess&&_(n,"fancy",l.$Chess.fancyGraphics)},i(e){o||(a&&a.i(),s&&s.i(),o=!0)},o(e){a&&a.o(),s&&s.o(),o=!1},d(e){e&&$(n),a&&a.d(),u[r].d(),i()}}}function Ye(e){switch(e){case 0:return"A";case 1:return"B";case 2:return"C";case 3:return"D";case 4:return"E";case 5:return"F";case 6:return"G";case 7:return"H";default:throw new Error("not a valid column")}}function Ze(e,n,t){let l,r;u(e,he,e=>{t("$Chess",l=e)}),he.newModal("settings",Ee);let s,o,i,a,c=0;function d(e,n){t("gameSize",c=e<n?e-200:n-200),r.style.height=c+"px",t("gameEl",r),r.style.width=c+"px",t("gameEl",r)}return e.$$.update=(e={$Chess:1,chessStore:1,gameSize:1})=>{e.$Chess&&t("chessStore",s=l),e.chessStore&&t("cpt",o=s.currentPlayerTurn),e.gameSize&&t("fieldSize",i=c/8)},t("reversedChessfield",a=e=>{let n=[];for(const t in e)n[7-t]=e[t];return n}),{startChess:function(){he.start(),setTimeout(()=>{d(window.innerWidth,window.innerHeight)})},gameEl:r,gameSize:c,onResize:function(e){s.inProcess&&d(e.target.innerWidth,e.target.innerHeight)},chessStore:s,$Chess:l,cpt:o,fieldSize:i,reversedChessfield:a,click_handler:function(){return he.openModal("settings")},click_handler_1:function({rowIndex:e,colIndex:n}){return he.selectField(7-e,n)},div8_binding:function(e,n){t("gameEl",r=e)}}}const en=new class extends ie{constructor(e){super(),oe(this,e,Ze,Xe,c,[])}}({target:document.body});window.app=en;n.default=en}]);